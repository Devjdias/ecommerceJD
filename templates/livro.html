<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/index.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/livro.css') }}" />
        <script src="{{ url_for('static', filename='js/livro.js') }}"></script>
    <link rel="shortcut icon" href="{{ url_for('static', filename='images/iconLivro.png') }}" />
    <title>{{ livro['titulo'] }} - ClicLeitura</title>
</head>

<!-- DATA-ATTRIBUTE PARA PASSAR O ID DO LIVRO AO JS -->
<div data-livro-id="{{ livro['id'] }}" style="display: none;"></div>

<body>
    <!-- HEADER -->
    <header class="header">
        <section>
            <a href="{{ url_for('index') }}" class="logo" aria-label="ClicLeitura - in√≠cio">
                <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Logo">
            </a>

            <nav class="navbar">
                <a href="{{ url_for('index') }}" class="active">Home</a>
                <a href="{{ url_for('sobre_page') }}">Sobre</a>
                <a href="#shop">E-books</a>
                <a href="{{ url_for('contato_page') }}">Contato</a>
                <a href="{{ url_for('localizacao_page') }}">Localiza√ß√£o</a>
                <a href="{{ url_for('faq_page') }}">FAQ</a>
            </nav>

            <div class="icons">
                <div id="carrinhoIcon" style="position: relative; display: inline-block; cursor: pointer;">
                    <img id="carrinhoImg" width="30" height="30"
                        src="https://img.icons8.com/?size=100&id=9671&format=png&color=4d0606" alt="Carrinho">
                    <span id="carrinhoCount" style="display: none; position: absolute; top: -8px; right: -8px; background: #e74c3c; color: rgb(255, 0, 0); border-radius: 50%; width: 20px; height: 20px; font-size: 12px; font-weight: bold; align-items: center; justify-content: center;"></span>
                </div>

                <a href="{{ url_for('login_page') }}" id="loginLink">
                    <img width="30" height="30" src="https://img.icons8.com/?size=100&id=24220&format=png&color=702727" alt="Entrar">
                </a>
                <a href="{{ url_for('perfil_page') }}" id="perfilLink" style="display: none;">
                    <img width="30" height="30" src="https://img.icons8.com/?size=100&id=7820&format=png&color=702727" alt="Perfil">
                </a>
                <span id="userInfo" style="display: none; color: #4d0606; font-weight: bold;"></span>
                <button id="logoutBtn" style="display: none; padding: 5px 15px; background: #f1f1f1; color: #4d0606; border: none; border-radius: 4px; cursor: pointer;">
                    <i class="fa-solid fa-arrow-right-from-bracket"></i> Sair
                </button>
            </div>
        </section>
    </header>

    <!-- MODAL DO LIVRO -->
    <div class="modal-livro-overlay active" id="modalLivro">
        <div class="modal-livro-content">
            <div class="modal-livro-header">
                <h2>{{ livro['titulo'] }}</h2>
                <button class="modal-livro-close" onclick="fecharModal()">&times;</button>
            </div>
            
            <div class="modal-livro-body">
                <div class="livro-detalhes-content">
                    <div class="livro-detalhes-imagem">
                        {% if livro['imagem'].startswith('http') %}
                            <img src="{{ livro['imagem'] }}" alt="{{ livro['titulo'] }}" />
                        {% else %}
                            <img src="{{ url_for('static', filename='images/' + livro['imagem']) }}" alt="{{ livro['titulo'] }}" />
                        {% endif %}
                    </div>
                    
                    <div class="livro-detalhes-info">
                        <h1>{{ livro['titulo'] }}</h1>
                        <p><strong>Autor:</strong> {{ livro['autor'] }}</p>
                        <p><strong>Fonte:</strong> {{ livro['origem'] }}</p>
                        
                        {% if livro['descricao'] %}
                        <div class="descricao-box">
                            <h3>üìñ Sobre este E-book</h3>
                            <p>{{ livro['descricao'] }}</p>
                        </div>
                        {% endif %}
                        
                        <div class="preco-box">
                            <h2>R$ {{ "%.2f"|format(livro['preco']) }}</h2>
                        </div>
                        
                        <div class="acoes-livro">
                            <button class="btn-secundario" onclick="adicionarAoCarrinho()">
                                üõí Adicionar ao Carrinho
                            </button>
                            <button class="btn-primario" onclick="abrirModalCheckout()">
                                üí≥ Comprar Agora
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL DE CHECKOUT -->
    <div class="modal-overlay" id="modalCheckout" onclick="fecharModalSeForaConteudo(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h3>üí≥ Finalizar Compra</h3>
                <button class="btn-fechar" onclick="fecharCheckoutModal()">√ó</button>
            </div>
            
            <div class="modal-body">
                <div class="info-compra">
                    <p><strong>üìö E-book:</strong> {{ livro['titulo'] }}</p>
                    <p><strong>üí∞ Valor:</strong> R$ {{ "%.2f"|format(livro['preco']) }}</p>
                    <p style="margin-top: 15px; font-size: 0.9rem;">
                        ‚úâÔ∏è Ap√≥s o pagamento, o e-book ser√° enviado automaticamente para seu e-mail!
                    </p>
                </div>
                
                <form id="checkoutForm" class="checkout-form">
                    <input type="email" id="emailInput" placeholder="Seu melhor e-mail" required />
                    <button type="submit">üîí Gerar PIX e Comprar</button>
                </form>
                
                <div class="qr-container" id="qrContainer">
                    <h3>üì± Escaneie o QR Code PIX</h3>
                    <img id="qrImage" src="" alt="QR Code PIX" />
                    <p id="pixText"></p>
                    <button class="btn-simular" onclick="simularPagamento()">
                        ‚úÖ Simular Pagamento Realizado
                    </button>
                    <div id="mensagemStatus"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- FOOTER -->
    <footer class="footer">
        <div class="footer-container">
            <!-- Coluna 1: Sobre -->
            <div class="footer-column">
                <h3>ClicLeitura</h3>
                <p>Sua livraria digital com os melhores e-books. Leitura de qualidade ao alcance de um clique.</p>
                <div class="social-icons">
                    <a href="#" aria-label="Facebook"><i class="fab fa-facebook"></i></a>
                    <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                    <a href="#" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                    <a href="#" aria-label="LinkedIn"><i class="fab fa-linkedin"></i></a>
                </div>
            </div>

            <!-- Coluna 2: Links R√°pidos -->
            <div class="footer-column">
                <h4>Links R√°pidos</h4>
                <ul>
                    <li><a href="#home">Home</a></li>
                    <li><a href="#sobre">Sobre N√≥s</a></li>
                    <li><a href="#shop">Cat√°logo</a></li>
                    <li><a href="{{ url_for('terms_page') }}">Termos de Servi√ßo</a></li>
                </ul>
            </div>

            <!-- Coluna 3: Atendimento -->
            <div class="footer-column">
                <h4>Atendimento</h4>
                <ul>
                    <li><a href="{{ url_for('faq_page') }}">FAQ</a></li>
                    <li><a href="{{ url_for('terms_page') }}">Pol√≠tica de Privacidade</a></li>
                    <li><a href="{{ url_for('faq_page') }}">Formas de Pagamento</a></li>
                    <li><a href="{{ url_for('contato_page') }}">Contato</a></li>
                </ul>
            </div>

            <!-- Coluna 4: Contato -->
            <div class="footer-column">
                <h4>Contato</h4>
                <ul class="contact-info">
                    <li><i class="fas fa-envelope"></i> contato@clicleitura.com</li>
                    <li><i class="fas fa-phone"></i> (68) 99219-1861</li>
                    <li><i class="fas fa-map-marker-alt"></i> <a href="{{ url_for('localizacao_page') }}"
                            style="color: inherit; text-decoration: none;">Rio Branco, AC</a></li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p>&copy; 2025 Todos os direitos reservados.</p>
        </div>
    </footer>

    <!-- MODAL DO CARRINHO -->
    <div id="carrinhoModal" class="carrinho-modal" style="display: none;">
        <div class="carrinho-content">
            <div class="carrinho-header">
                <h2><i class="fas fa-shopping-cart"></i> Meu Carrinho</h2>
                <button class="carrinho-close" onclick="fecharCarrinho()">&times;</button>
            </div>
            <div id="carrinhoItens" class="carrinho-itens">
                <!-- Itens do carrinho ser√£o inseridos aqui -->
            </div>
            <div class="carrinho-footer">
                <div class="carrinho-total">
                    <span>Total:</span>
                    <span id="carrinhoTotal">R$ 0,00</span>
                </div>
                <button class="btn-finalizar" onclick="fecharPedidoEPagarComPix()">
                    <i class="fas fa-qrcode"></i> Fechar Pedido e Pagar com PIX
                </button>
            </div>
        </div>
    </div>

    <!-- MODAL DE PAGAMENTO PIX -->
    <div id="pixModal" class="carrinho-modal" style="display: none;">
        <div class="carrinho-content" style="max-width: 600px;">
            <div class="carrinho-header">
                <h2><i class="fas fa-qrcode"></i> Pagamento PIX</h2>
                <button class="carrinho-close" onclick="fecharPixModal()">&times;</button>
            </div>
            <div class="pix-content" style="padding: 2rem; text-align: center;" id="pixInfo">
                <!-- Informa√ß√µes do PIX ser√£o inseridas aqui -->
            </div>
        </div>
    </div>
    
    <!-- Script do carrinho -->
    <script src="{{ url_for('static', filename='js/carrinho.js') }}"></script>
    <script src="{{ url_for('static', filename='js/carrinho-funcoes.js') }}"></script>

</body>

</html>